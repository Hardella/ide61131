<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Features and limits  Hardella IDE</title>




<meta name="description" content="Features and limits of PRU programming in Hardella IDE. Hardella is a capable IDE for PLC programming in 61131 languages (ST, etc)">




<meta property="og:locale" content="en">
<meta property="og:site_name" content="Hardella IDE">
<meta property="og:title" content="Features and limits">


  <link rel="canonical" href="/ide61131/en/docs/pru/features-and-limits/">
  <meta property="og:url" content="https://hardella.github.io/ide61131/docs/pru/features-and-limits/">



  <meta property="og:description" content="Features and limits of PRU programming in Hardella IDE. Hardella is a capable IDE for PLC programming in 61131 languages (ST, etc)">





















<!-- end SEO -->


<link href="/ide61131/en/feed.xml" type="application/atom+xml" rel="alternate" title="Hardella IDE Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/ide61131/en/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    <link rel="apple-touch-icon" sizes="180x180" href="/ide61131/en/assets/images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" href="/ide61131/en/assets/images/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/ide61131/en/assets/images/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/ide61131/en/assets/images/favicons/manifest.json">
<link rel="mask-icon" href="/ide61131/en/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">
<meta http-equiv="Content-Language" content="en"><link rel="alternate" i18n="ru" href="https://hardella.com/docs/pru/features-and-limits/" />
<link rel="alternate" i18n="en" href="https://hardella.com/en/docs/pru/features-and-limits/" />

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
    <div class="masthead__inner-wrap">
        <div class="masthead__menu">
            <nav id="site-nav" class="greedy-nav">
                <button><div class="navicon"></div></button>
                <ul class="visible-links">
                    <li class="masthead__menu-item masthead__menu-item--lg"><a href="/ide61131/en/"><img src="/assets/images/hardella.iconset/icon_128x128.png" style="height: 2em;"> Hardella IDE</a></li>
                    
                    
                    <li class="masthead__menu-item"><a href=" https://hardella.github.io/ide61131/docs/pru/features-and-limits/ ">Ru</a></li>
                    
                    
                    
                    
                    
                    
                    <li class="masthead__menu-item"><a href="/ide61131/en/blog">News</a></li>
                    
                    
                    <li class="masthead__menu-item"><a href="/ide61131/en/docs/introduction">Documentation</a></li>
                    
                    
                    <li class="masthead__menu-item"><a href="https://groups.google.com/forum/#!forum/hardella-forum" target="_blank">Forum</a></li>
                    
                    
                    <li class="masthead__menu-item"><a href="/ide61131/en/donate">Donate</a></li>
                    
                    
                    <li class="masthead__menu-item"><a href="/ide61131/en/download">Download</a></li>
                    
                </ul>
                <ul class="hidden-links hidden"></ul>
            </nav>
        </div>
    </div>
</div>

    



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title"></span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/introduction/" class="">Introduction</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/upgrade/" class="">Upgrade</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/changelog/" class="">Changelog</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Hardella tricks</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/ide/navigation/" class="">Code browsing</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/ide/editor/" class="">Code editing</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">AM1808 PRU (PLC110[М02])</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/features-and-limits/" class="active">Features and limitations</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/new-project/" class="">Creating a project in Hardella</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/project-build/" class="">Compilation of a PRU project</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/codesys-setup/" class="">CoDeSys setup</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/data-exchange/" class="">PRU data exchange</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/standard-library/" class="">Standard library</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">AM1808 PRU examples</span>
        

        
        <ul>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/examples/four-blinkning-leds" class="">Blinking leds</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/examples/fast-counter" class="">Fast counter</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/examples/fast-encoder" class="">Fast encoder</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/examples/fast-pwm" class="">PWM output</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/examples/step-motor" class="">Step motor</a></li>
          
            
            

            
            

            <li><a href="/ide61131/en/docs/pru/examples/material-cutter" class="">Precise motor control</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Features and limits">
    <meta itemprop="description" content="Features and limits of PRU programming in Hardella IDE. Hardella is a capable IDE for PLC programming in 61131 languages (ST, etc)">
    
    <meta itemprop="dateModified" content="December 25, 2016">

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Features and limits
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-columns"></i> Hardella for PRU programms</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#hardella-vs-codesys" id="markdown-toc-hardella-vs-codesys">Hardella vs CoDeSys</a></li>
  <li><a href="#plc110-М02-specifications" id="markdown-toc-plc110-М02-specifications">PLC110 М02 specifications</a></li>
  <li><a href="#available-options-to-drive-pru" id="markdown-toc-available-options-to-drive-pru">Available options to drive PRU</a></li>
  <li><a href="#programming-language" id="markdown-toc-programming-language">Programming language</a></li>
  <li><a href="#pru-program-execution-model" id="markdown-toc-pru-program-execution-model">PRU program execution model</a></li>
</ul>

  </nav>
</aside>

<p>To make long story short, you can create free-style 1µs programs.
You can process encoder inputs, you can control step motors. When using PRU program, you are not limited with 1ms cycle time of the main program. PRU cycle times are 1000 times faster, so you have a lot more fine grained control.</p>

<p>AM1808 CPU has two PRU cores, each of those operate at high frequency and the cores have direct access to fast inputs and outputs.</p>

<p>PRU cores operate at 200 MHz, and almost every command takes just 1 CPU tick to execute. The good part is PRU has no background program to execute, so you have dedicate processing power.</p>

<p>Of course it takes more than 1 tick to execute a complex program, however you can fit a lot in 200 ticks. So having cycle times of 1 µs should be doable.</p>

<p>The hard limit of a PRU core program is 1024 instructions. As you consider that there’s just 2 outputs connected to each core, you might realize that 1024 is “enough for everybody”. Instruction set includes simple 32 bit int math (<strong>without</strong> multiplication/division), and conditional jumps.</p>

<p>For instance, you can use PRU program to “disable the motor as soon as the required number of pulses arrives”.</p>

<h2 id="hardella-vs-codesys">Hardella vs CoDeSys</h2>

<p>You can skip this section if you wish.</p>

<p>CoDeSys does not support PRU programming, so “PRU program” is composed in Hardella IDE. At the end of the day, everything is controlled from the main PLC loop, that is controlled by CoDeSys.</p>

<p>This works like the following:</p>
<ol>
  <li>PRU is created in ST language in Hardella</li>
  <li>Hardella compiles the code into PRU machine code</li>
  <li>The compiled code is passed as a byte array in ST language to CoDeSys in a <code class="highlighter-rouge">.exp</code> format</li>
  <li>“Main PLC loop” uploads the program to PRU when the PLC is started, and PRU starts processing</li>
</ol>

<h2 id="plc110-М02-specifications">PLC110 М02 specifications</h2>

<p>PRU programs were tested using <a href="http://www.owen.ru/catalog/programmiruemij_logicheskij_kontroller_oven_plk110/opisanie">OWEN PLC110 М02</a>.</p>

<ul>
  <li>PRU frequency: 200 МГц (lots of commands take 5 ns to execute)</li>
  <li>Number of PRU cores: 2. PRU0 и PRU1</li>
  <li>Fast inputs 1, 2, 3 and 4 are assigned to PRU0</li>
  <li>Fast outputs 1 and 2 are assigned to PRU1</li>
  <li>Fast outputs 3 and 4 are assigned to PRU0</li>
  <li>Maximal PRU program size: 1024 assembly instructions</li>
  <li>Amount of registry memory available: ~30 <code class="highlighter-rouge">DWORD</code> registers (~120 bytes)</li>
</ul>

<h2 id="available-options-to-drive-pru">Available options to drive PRU</h2>

<p>By default fast inputs and outputs are configured in <code class="highlighter-rouge">PLC Configuration</code> in CoDeSys, however you can switch PRU to free programming mode.</p>

<p>Due to the PLC110 firmware limitations, only the following options are supported:</p>

<table>
  <thead>
    <tr>
      <th>PRU0</th>
      <th>PRU1</th>
      <th>Comment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>PLC Configuration</td>
      <td>PLC Configuration</td>
      <td>Default mode</td>
    </tr>
    <tr>
      <td>Free program</td>
      <td>PLC Configuration</td>
      <td>PRU0 runs user program</td>
    </tr>
    <tr>
      <td>Free program</td>
      <td>Free program</td>
      <td>Two programs at the same time</td>
    </tr>
  </tbody>
</table>

<h2 id="programming-language">Programming language</h2>

<p>PRU programming language is ST with certain limitations:</p>
<ul>
  <li>Complex expressions are not supported yet. For instance, in order to create <code class="highlighter-rouge">d := a+b-c</code> expression, you need to create a temporary variable as follows: <code class="highlighter-rouge">u := b-c; d:= a+b;</code>. Don’t hesitate to create lots of temporary variables, as the system is typically smart enough to identify temporary variables. On contrary, if you use the same variable for different purposes, it might confuse the compiler.</li>
  <li>Complex conditions with <code class="highlighter-rouge">AND</code>, <code class="highlighter-rouge">OR</code> in conditional statements (<code class="highlighter-rouge">IF</code>, <code class="highlighter-rouge">WHILE</code>, <code class="highlighter-rouge">REPEAT</code>) might fail to work. If the code got compiled, then it is fine, however there are unsupported cases that will result in compilation error.</li>
  <li><code class="highlighter-rouge">FUNCTION</code> is not supported</li>
  <li>Structures are note supported</li>
  <li>Arrays are not supported</li>
  <li><strong>Only</strong> <code class="highlighter-rouge">unsigned</code> data types are supported: <code class="highlighter-rouge">BOOL</code>, <code class="highlighter-rouge">BYTE</code>, <code class="highlighter-rouge">WORD</code>, <code class="highlighter-rouge">DWORD</code> and <code class="highlighter-rouge">ENUM</code></li>
  <li>All the variables are placed in the PRU registers. The code might fail to compile if you have lots of live variables. However intermediate calculations might reuse the same register, so the limit is not the number of variables, but the number of live variables.</li>
</ul>

<p>Features:</p>
<ul>
  <li>There’s no “current time” function, however you can access PRU tick counter. Every tick is 5 ns. Remember, there’s no div/multiply, so it is better to convert time to PRU ticks if you need notion of time.</li>
  <li>You can use inline assembly in the ST code if you need</li>
</ul>

<h2 id="pru-program-execution-model">PRU program execution model</h2>

<p>Each PRU core follows the typical “cycle with fixed duration”.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>WHILE TRUE DO
  execution_of_user_code(); (* &lt;-- this executes user-provided code *)
  
  REPEAT 
     Data_exchange_with_main_program();
     Read_inputs();
  UNTIL need_to_wait_next_cyle 
  END_REPEAT;
  
  Write_outputs();
  Read_inputs(); (* just in case *)
END_WHILE;
</code></pre>
</div>

<p>The cycle length is specified at build time and you can configure it via <code class="highlighter-rouge">PRU Configuration</code> object.
Like in a regular PLC, user-provided code should not use <code class="highlighter-rouge">WHILE TRUE</code>. That loop will be added by IDE automatically. User should just create a <code class="highlighter-rouge">PROGRAM</code> and specify which PRU core should execute that program.</p>

<p>In general PRU programming is close to PLC programing. The difference is PRU cycle length is way smaller.</p>

        
      </section>

      <footer class="page__meta">
        
        


                
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-12-25">December 25, 2016 20:49</time></p>
        

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/ide61131/en/docs/ide/editor/" class="pagination--pager" title="Code editing
">Previous</a>
    
    
      <a href="/ide61131/en/docs/pru/new-project/" class="pagination--pager" title="Creating a PRU project in Hardella
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
    <h4 class="page__comments-title">Leave a Comment</h4>
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
</div>

    <div class="page__footer">
      <footer>
        <a href="//orphus.ru" id="orphus" target="_blank"><img alt="Система Orphus" src="/assets/images/orphus.gif" border="0" width="257" height="48" /></a><br><br>

        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/Hardella"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="/ide61131/en/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2016 Hardella IDE. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="https://hardella.github.io/ide61131/assets/js/main.min.js"></script>




  <!-- Yandex.Metrika counter --> <script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter41689319 = new Ya.Metrika({ id:41689319, clickmap:true, trackLinks:true, accurateTrackBounce:true, webvisor:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks"); </script> <noscript><div><img src="https://mc.yandex.ru/watch/41689319" style="position:absolute; left:-9999px;" alt="" /></div></noscript> <!-- /Yandex.Metrika counter -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-62628294-3', 'auto');
    ga('send', 'pageview');
</script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'hardella';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.2/anchor.min.js"></script>
<script language="JavaScript">
    anchors.add('article h1, article h2, article h3, article h4, article h5');
</script>
<script type="text/javascript" src="/assets/js/orphus.js"></script>


  </body>
</html>
